<div class="container-fluid g-0 p-3">
    <div class="card shadow-lg">
        <div class="card-body">

            <!-- Card Başlığı -->
            <h2 class="card-title text-center fs-4">{{cardHeader}}</h2>
            <!-- /Card Başlığı -->

            <!-- Banka Ekleme/Düzenleme Formu -->
            <form #form="ngForm" (ngSubmit)="save(selectedBankExtDto)">
                <!-- Şube -->
                <div class="mt-3 mb-3">
                    <label class="mb-2" for="branch-id">Şube</label>
                    <select 
                        id="branch-id"
                        name="branchId"
                        class="form-select"
                        [(ngModel)]="selectedBankExtDto.branchId"
                        [ngClass]="{ 'is-invalid': submitted && selectedBankExtDtoErrors.branchId }"
                        [disabled]="selectedBankExtDto.accountId != 0"
                        (change)="selectedBankExtDtoErrors.branchId = ''"
                        tabindex="1"
                    >
                        <option 
                            *ngFor="let branchDto of branchDtos"
                            [value]="branchDto.branchId"
                        >
                            {{branchDto.branchName}}
                        </option>
                    </select>
                    <div class="invalid-feedback" *ngIf="submitted && selectedBankExtDtoErrors.branchId">
                        <div>{{selectedBankExtDtoErrors.branchId}}</div>
                    </div>
                </div>
                <!-- /Şube -->
    
                <!-- Hesap Adı -->
                <div class="mt-3 mb-3">
                    <label class="form-label" for="account-name">Hesap Adı</label>
                    <input
                        id="account-name"
                        type="text"
                        name="accountName"
                        [(ngModel)]="selectedBankExtDto.accountName"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': submitted && selectedBankExtDtoErrors.accountName }"
                        (change)="selectedBankExtDtoErrors.accountName = ''"
                        tabindex="2"
                    />
                    <div class="invalid-feedback" *ngIf="submitted && selectedBankExtDtoErrors.accountName">
                        <div>{{selectedBankExtDtoErrors.accountName}}</div>
                    </div>
                </div>
                <!-- /Hesap Adı -->

                <!-- Hesap Kodu -->
                <div class="mt-3 mb-3">
                    <div class="d-flex justify-content-between">
                        <label class="form-label" for="account-code">Hesap Kodu</label>

                        <!-- Hesap Kodu Üretme Butonu -->
                        <a class="code-link cursor-pointer" (click)="generateAccountCode()" *ngIf="selectedBankExtDto.accountId == 0"><small>Kod Üret</small></a>
                        <!-- /Hesap Kodu Üretme Butonu -->
                    </div>
                    <input
                        id="account-code"
                        type="text"
                        name="accountCode"
                        [(ngModel)]="selectedBankExtDto.accountCode"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': submitted && selectedBankExtDtoErrors.accountCode }"
                        [readOnly]="selectedBankExtDto.accountId != 0"
                        (change)="selectedBankExtDtoErrors.accountCode = ''"
                        tabindex="3"
                    />
                    <div class="invalid-feedback" *ngIf="submitted && selectedBankExtDtoErrors.accountCode">
                        <div>{{selectedBankExtDtoErrors.accountCode}}</div>
                    </div>

                </div>
                <!-- /Hesap Kodu -->

                <!-- Limit -->
                <div class="mt-3 mb-3">
                    <label class="form-label" for="limit">Limit</label>
                    <input
                        id="limit"
                        type="number"
                        name="limit"
                        [(ngModel)]="selectedBankExtDto.limit"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': submitted && selectedBankExtDtoErrors.limit }"
                        (change)="selectedBankExtDtoErrors.limit = ''"
                        tabindex="4"
                    />
                    <div class="invalid-feedback" *ngIf="submitted && selectedBankExtDtoErrors.limit">
                        <div>{{selectedBankExtDtoErrors.limit}}</div>
                    </div>
                </div>
                <!-- /Limit -->

                <!-- Standart Vade -->
                <div class="mt-3 mb-3">
                    <label class="form-label" for="standartMaturity">Standart Vade</label>
                    <input
                        id="standart-maturity"
                        type="number"
                        name="standartMaturity"
                        [(ngModel)]="selectedBankExtDto.standartMaturity"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': submitted && selectedBankExtDtoErrors.standartMaturity }"
                        (change)="selectedBankExtDtoErrors.standartMaturity = ''"
                        tabindex="5"
                    />
                    <div class="invalid-feedback" *ngIf="submitted && selectedBankExtDtoErrors.standartMaturity">
                        <div>{{selectedBankExtDtoErrors.standartMaturity}}</div>
                    </div>
                </div>
                <!-- /Standart Vade -->
                
                <!-- Döviz Tipi -->
                <div class="mt-3 mb-3">
                    <label class="mb-2" for="currency-id">Döviz Tipi</label>
                    <select 
                        id="currency-id"
                        name="currencyId"
                        class="form-select"
                        [(ngModel)]="selectedBankExtDto.currencyId"
                        [ngClass]="{ 'is-invalid': submitted && selectedBankExtDtoErrors.currencyId }"
                        [disabled]="selectedBankExtDto.accountId != 0"
                        (change)="selectedBankExtDtoErrors.currencyId = ''"
                        tabindex="6"
                    >
                        <option 
                            *ngFor="let currencyDto of currencyDtos"
                            [value]="currencyDto.currencyId"
                        >
                            {{currencyDto.currencyName}}
                        </option>
                    </select>
                    <div class="invalid-feedback" *ngIf="submitted && selectedBankExtDtoErrors.currencyId">
                        <div>{{selectedBankExtDtoErrors.currencyId}}</div>
                    </div>
                </div>
                <!-- /Döviz Tipi -->
                
                <!-- Banka Adı -->
                <div class="mt-3 mb-3">
                    <label class="form-label" for="bank-name">Banka Adı</label>
                    <input
                        id="bank-name"
                        type="text"
                        name="bankName"
                        [(ngModel)]="selectedBankExtDto.bankName"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': submitted && selectedBankExtDtoErrors.bankName }"
                        (change)="selectedBankExtDtoErrors.bankName = ''"
                        tabindex="7"
                    />
                    <div class="invalid-feedback" *ngIf="submitted && selectedBankExtDtoErrors.bankName">
                        <div>{{selectedBankExtDtoErrors.bankName}}</div>
                    </div>
                </div>
                <!-- /Banka Adı -->

                <!-- Banka Şube Adı -->
                <div class="mt-3 mb-3">
                    <label class="form-label" for="bank-branch-name">Banka Şube Adı</label>
                    <input
                        id="bank-branch-name"
                        type="text"
                        name="bankBranchName"
                        [(ngModel)]="selectedBankExtDto.bankBranchName"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': submitted && selectedBankExtDtoErrors.bankBranchName }"
                        (change)="selectedBankExtDtoErrors.bankBranchName = ''"
                        tabindex="8"
                    />
                    <div class="invalid-feedback" *ngIf="submitted && selectedBankExtDtoErrors.bankBranchName">
                        <div>{{selectedBankExtDtoErrors.bankBranchName}}</div>
                    </div>
                </div>
                <!-- /Banka Şube Adı -->

                <!-- Banka Kodu -->
                <div class="mt-3 mb-3">
                    <label class="form-label" for="bank-code">Banka Kodu</label>
                    <input
                        id="bank-code"
                        type="text"
                        name="bankCode"
                        [(ngModel)]="selectedBankExtDto.bankCode"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': submitted && selectedBankExtDtoErrors.bankCode }"
                        (change)="selectedBankExtDtoErrors.bankCode = ''"
                        tabindex="9"
                    />
                    <div class="invalid-feedback" *ngIf="submitted && selectedBankExtDtoErrors.bankCode">
                        <div>{{selectedBankExtDtoErrors.bankCode}}</div>
                    </div>
                </div>
                <!-- /Banka Kodu -->

                <!-- Banka Şube Kodu -->
                <div class="mt-3 mb-3">
                    <label class="form-label" for="bank-branch-code">Banka Şube Kodu</label>
                    <input
                        id="bank-branch-code"
                        type="text"
                        name="bankBranchCode"
                        [(ngModel)]="selectedBankExtDto.bankBranchCode"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': submitted && selectedBankExtDtoErrors.bankBranchCode }"
                        (change)="selectedBankExtDtoErrors.bankBranchCode = ''"
                        tabindex="10"
                    />
                    <div class="invalid-feedback" *ngIf="submitted && selectedBankExtDtoErrors.bankBranchCode">
                        <div>{{selectedBankExtDtoErrors.bankBranchCode}}</div>
                    </div>
                </div>
                <!-- /Banka Şube Kodu -->

                <!-- Banka Hesap Numarası -->
                <div class="mt-3 mb-3">
                    <label class="form-label" for="bank-account-code">Banka Hesap Numarası</label>
                    <input
                        id="bank-account-code"
                        type="text"
                        name="bankAccountCode"
                        [(ngModel)]="selectedBankExtDto.bankAccountCode"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': submitted && selectedBankExtDtoErrors.bankAccountCode }"
                        (change)="selectedBankExtDtoErrors.bankAccountCode = ''"
                        tabindex="11"
                    />
                    <div class="invalid-feedback" *ngIf="submitted && selectedBankExtDtoErrors.bankAccountCode">
                        <div>{{selectedBankExtDtoErrors.bankAccountCode}}</div>
                    </div>
                </div>
                <!-- /Banka Hesap Numarası -->
                
                <!-- Iban -->
                <div class="mt-3 mb-3">
                    <label class="form-label" for="iban">Iban</label>
                    <input
                        id="iban"
                        type="text"
                        name="iban"
                        [(ngModel)]="selectedBankExtDto.iban"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': submitted && selectedBankExtDtoErrors.iban }"
                        (change)="selectedBankExtDtoErrors.iban = ''"
                        tabindex="12"
                    />
                    <div class="invalid-feedback" *ngIf="submitted && selectedBankExtDtoErrors.iban">
                        <div>{{selectedBankExtDtoErrors.iban}}</div>
                    </div>
                </div>
                <!-- /Iban -->
                
                <!-- Yetkili Adı -->
                <div class="mt-3 mb-3">
                    <label class="form-label" for="officer-name">Yetkili Adı</label>
                    <input
                        id="officer-name"
                        type="text"
                        name="officerName"
                        [(ngModel)]="selectedBankExtDto.officerName"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': submitted && selectedBankExtDtoErrors.officerName }"
                        (change)="selectedBankExtDtoErrors.officerName = ''"
                        tabindex="13"
                    />
                    <div class="invalid-feedback" *ngIf="submitted && selectedBankExtDtoErrors.officerName">
                        <div>{{selectedBankExtDtoErrors.officerName}}</div>
                    </div>
                </div>
                <!-- /Yetkili Adı -->

                <!-- Şehir -->
                <div class="mt-3 mb-3">
                    <label class="mb-2" for="city-id">Şehir</label>
                    <select 
                        id="city-id"
                        name="cityId"
                        class="form-select"
                        [(ngModel)]="selectedBankExtDto.cityId"
                        (change)="selectCity(selectedBankExtDto.cityId)"
                        [ngClass]="{ 'is-invalid': submitted && selectedBankExtDtoErrors.cityId }"
                        (change)="selectedBankExtDtoErrors.cityId = ''"
                        tabindex="14"
                    >
                        <option 
                            *ngFor="let cityDto of cityDtos"
                            [value]="cityDto.cityId"
                        >
                            {{cityDto.cityName}}
                        </option>
                    </select>
                    <div class="invalid-feedback" *ngIf="submitted && selectedBankExtDtoErrors.cityId">
                        <div>{{selectedBankExtDtoErrors.cityId}}</div>
                    </div>
                </div>
                <!-- /Şehir -->
    
                <!-- İlçe -->
                <div class="mt-3 mb-3">
                    <label class="mb-2" for="district-id">İlçe</label>
                    <select 
                        id="district-id"
                        name="districtId"
                        class="form-select"
                        [(ngModel)]="selectedBankExtDto.districtId"
                        [ngClass]="{ 'is-invalid': submitted && selectedBankExtDtoErrors.districtId }"
                        (change)="selectedBankExtDtoErrors.districtId = ''"
                        tabindex="15"
                    >
                        <option 
                            *ngFor="let districtDto of districtDtos"
                            [value]="districtDto.districtId"
                        >
                            {{districtDto.districtName}}
                        </option>
                    </select>
                    <div class="invalid-feedback" *ngIf="submitted && selectedBankExtDtoErrors.districtId">
                        <div>{{selectedBankExtDtoErrors.districtId}}</div>
                    </div>
                </div>
                <!-- /İlçe -->
                
                <!-- Adres -->
                <div class="mt-3 mb-3">
                    <label class="form-label" for="address-text">Adres</label>
                    <textarea
                        id="address-text"
                        type="text"
                        name="addressText"
                        [(ngModel)]="selectedBankExtDto.addressText"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': submitted && selectedBankExtDtoErrors.addressText }"
                        (change)="selectedBankExtDtoErrors.addressText = ''"
                        tabindex="16"
                    ></textarea>
                    <div class="invalid-feedback" *ngIf="submitted && selectedBankExtDtoErrors.addressText">
                        <div>{{selectedBankExtDtoErrors.addressText}}</div>
                    </div>
                </div>
                <!-- /Adres -->

                <!-- Butonlar -->
                <div class="container-fluid m-0">
                    <div class="row">
                        <div class="col-6">
                            <button 
                                type="submit" 
                                class="btn btn-success w-100" 
                                [disabled]="loading"
                                tabindex="17"
                            >
                                <span *ngIf="loading" class="spinner-border spinner-border-sm me-1"></span>Kaydet
                            </button>
                        </div>
                        <div class="col-6">
                            <button 
                                type="button" 
                                class="btn btn-secondary w-100"
                                (click)="cancel()"
                            >İptal
                            </button>
                        </div>
                    </div>
                </div>
                <!-- /Butonlar -->
            </form>
            <!-- /Banka Ekleme/Düzenleme Formu -->
        </div>
    </div>
</div>
    